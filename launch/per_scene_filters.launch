<launch>

    <node pkg="nodelet" type="nodelet" name="pcl_manager_global" args="manager" output="screen" />

    <!-- CropBox -->
    <node pkg="nodelet" type="nodelet" name="crop_box" args="load pcl/CropBox pcl_manager_global" output="screen">
        <remap from="~input" to="/points_concatenated" />
        <remap from="~output" to="/points_cropped" />
        <rosparam>
        min_x: 0.1
        max_x: 0.8
        min_y: -0.7
        max_y: 0.15
        min_z: -0.1
        max_z: 0.7
        input_frame: /world
        </rosparam>
    </node>

    <!-- Run a VoxelGrid filter to clean NaNs and downsample the data -->
    <node pkg="nodelet" type="nodelet" name="voxel_grid" args="load pcl/VoxelGrid pcl_manager_global" output="screen">
      <remap from="~input" to="/points_cropped" />
      <remap from="~output" to="/points_voxelized" />
      <rosparam>
        filter_field_name: z
        filter_limit_min: -2
        filter_limit_max: 2
        filter_limit_negative: False
        leaf_size: 0.001
      </rosparam>
    </node>

    <!-- RadiusOutlierRemoval -->
    <!-- <node pkg="nodelet" type="nodelet" name="radius_outlier_removal" args="load pcl/RadiusOutlierRemoval pcl_manager_global" output="screen">
        <remap from="~input" to="/voxelized_points" />
        <remap from="~output" to="/downsampled_points" />
        <rosparam>
        radius_search: 0.005
        min_neighbors: 25
        </rosparam>
    </node> -->


    <node pkg="nodelet" type="nodelet" name="outlier" args="load pcl/StatisticalOutlierRemoval pcl_manager_global" output="screen">
        <remap from="~input" to="/points_voxelized" />
        <remap from="~output" to="/points_downsampled" />
        <rosparam>
        mean_k: 5
        stddev: 0.1
        negative: false
        </rosparam>
    </node>



</launch>